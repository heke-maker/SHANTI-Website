<div class="tweets-timeline-container">
  <%# --- 1. „Éò„ÉÉ„ÉÄ„Éº„Ç®„É™„Ç¢ --- %>
  <div class="tweets-header">
    <h1>COMMUNITY BOARD <span>- „Åø„Çì„Å™„ÅÆÊ¥ªÂãï„É°„É¢ -</span></h1>
    <p>Êó•„ÄÖ„ÅÆÊ¥ªÂãï„ÅÆÊßòÂ≠ê„ÇÑ„ÄÅÂèÇÂä†„Åó„ÅüÊÑüÊÉ≥„Çí„Ç∑„Çß„Ç¢„Åó„Çà„ÅÜÔºÅ</p>
    <%= link_to 'Êñ∞„Åó„ÅèÊäïÁ®ø„Åô„Çã', new_tweet_path, class: "new-post-btn" %>
  </div>

  <%# --- 2. Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº„Ç®„É™„Ç¢ --- %>
  <div class="search-section">
    <%= form_with(url: tweets_path, method: :get, local: true, class: "search-form") do |f| %>
      <%= f.text_field :search, placeholder: "„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢...", class: "search-input" %>
      <%= f.submit "Ê§úÁ¥¢„Åô„Çã", class: "search-submit" %>
    <% end %>
  </div>

  <%# ÁÆ°ÁêÜËÄÖÁî®Èö†„Åó„É™„É≥„ÇØ %>
  <% if user_signed_in? && current_user.admin? %>
    <div style="text-align: center; margin-bottom: 20px;">
      <%= link_to "üîß „É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ", users_path, class: "admin-link" %>
    </div>
  <% end %>

  <%# --- 3. „Çø„Ç§„É†„É©„Ç§„É≥Ôºà„Ç´„Éº„Éâ‰∏ÄË¶ßÔºâ --- %>
  <div class="tweets-grid">
    <% @tweets.each do |t| %>
      <div class="tweet-card">
        <div class="tweet-card-inner">
          
          <%# „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± %>
          <div class="tweet-user-info">
            <span class="user-badge"><%= t.category.presence || "MEMBER" %></span>
            <span class="user-email"><%= t.user&.email %></span>
          </div>

          <%# „É°„Éá„Ç£„Ç¢ÔºàÂãïÁîª„ÉªÁîªÂÉèÔºâ %>
          <div class="tweet-media">
            <%= video_tag t.video_url, controls: true, class: "tweet-video" if t.video? %>
            <% if t.image.attached? %>
              <%= image_tag t.image, class: "tweet-image" %>
            <% end %>
          </div>
          
          <%# „Ç≥„É≥„ÉÜ„É≥„ÉÑ %>
          <div class="tweet-content">
            <h3 class="tweet-title"><%= t.title %></h3>
            <p><%= t.about %></p>
          </div>

          <%# „ÅÑ„ÅÑ„Å≠ ÔºÜ „Ç¢„ÇØ„Ç∑„Éß„É≥ %>
          <div class="tweet-footer">
            <div class="like-section">
              <% if user_signed_in? %>
                <% if current_user.already_liked?(t) %>
                  <%= link_to tweet_like_path(id: t.id, tweet_id: t.id), method: :delete, class: "like-btn active" do %>
                    <i class="fa-solid fa-heart"></i> <%= t.likes.count %>
                  <% end %>
                <% else %>
                  <%= link_to tweet_likes_path(id: t.id, tweet_id: t.id), method: :post, class: "like-btn" do %>
                    <i class="fa-regular fa-heart"></i> <%= t.likes.count %>
                  <% end %>
                <% end %>
              <% else %>
                <span class="like-btn"><i class="fa-solid fa-heart"></i> <%= t.likes.count %></span>
              <% end %>
            </div>

            <div class="tweet-actions">
              <%= link_to 'Ë©≥Á¥∞„Å∏', tweet_path(t.id), class: "action-link" %>
              
              <% if user_signed_in? %>
                <% if current_user.id == t.user_id || current_user.admin? %>
                  <%= link_to "Á∑®ÈõÜ", edit_tweet_path(t.id), class: "action-link" %>
                  <%= link_to "ÂâäÈô§", tweet_path(t.id), method: :delete, data: { confirm: 'Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü' }, class: "action-link delete" %>
                <% end %>
              <% end %>
            </div>
          </div>
          <div class="tweet-date-footer">
            <%= t.created_at.strftime("%Y.%m.%d") %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>